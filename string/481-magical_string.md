### [481. 神奇字符串](https://leetcode.cn/problems/magical-string/)

- 中等

神奇字符串 `s` 仅由 `'1'` 和 `'2'` 组成，并需要遵守下面的规则：

- 神奇字符串 s 的神奇之处在于，串联字符串中 `'1'` 和 `'2'` 的连续出现次数可以生成该字符串。

`s` 的前几个元素是 `s = "1221121221221121122……"` 。如果将 `s` 中连续的若干 `1` 和 `2` 进行分组，可以得到 `"1 22 11 2 1 22 1 22 11 2 11 22 ......"` 。每组中 `1` 或者 `2` 的出现次数分别是 `"1 2 2 1 1 2 1 2 2 1 2 2 ......"` 。上面的出现次数正是 `s` 自身。

给你一个整数 `n` ，返回在神奇字符串 `s` 的前 `n` 个数字中 `1` 的数目。

**示例 1：**

```
输入：n = 6
输出：3
解释：神奇字符串 s 的前 6 个元素是 “122112”，它包含三个 1，因此返回 3 。 
```

**示例 2：**

```
输入：n = 1
输出：1
```

**提示：**

- `1 <= n <= 10^5`

**解法一：双指针模拟**

关键：

- 计数串和原串相同
- 计数串一定不长于对应的原串

思路：

给定一个原串的开头 `'122'`

对应的计数串为 `'12'`

然后用双指针 `i` 读取下一个分组（计数串下标），用 `j` 为下一个原串赋值

每次操作为一个分组，要先确定该分组大小和分组元素

生成的同时要记录 `1` 的个数

```python
class Solution:
    def magicalString(self, n: int) -> int:
        if n < 4:
            return 1
        s = [''] * n
        s[:3] = "122"
        res = 1
        # i指向分组大小，j指向构造的字符串
        i, j = 2, 3
        while j < n:
            # 先确定下一个分组的大小，再确定下一个分组的字符，前1后2，前2后1
            size = int(s[i])
            num = 3 - int(s[j - 1])
            while size and j < n:
                s[j] = str(num)
                if num == 1:
                    res += 1
                j += 1
                size -= 1
            i += 1
        return res
```

